\documentclass[11pt]{article}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb,mathtools}
\usepackage{microtype}
\usepackage{enumitem}
\usepackage{hyperref}
\usepackage{booktabs}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{tikz}

\hypersetup{colorlinks=true,linkcolor=blue,citecolor=blue,urlcolor=blue}
\setlist{itemsep=2pt,parsep=2pt,topsep=4pt}

% Theorem environments
\newtheorem{theorem}{Theorem}[section]
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{cor}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}

% Macros
\newcommand{\CH}{\operatorname{CH}}
\newcommand{\Pic}{\operatorname{Pic}}
\newcommand{\NS}{\operatorname{NS}}
\newcommand{\Spec}{\operatorname{Spec}}
\newcommand{\End}{\operatorname{End}}
\newcommand{\Hom}{\operatorname{Hom}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\im}{\operatorname{im}}
\newcommand{\coker}{\operatorname{coker}}
\newcommand{\QQ}{\mathbb{Q}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\PP}{\mathbb{P}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\id}{\mathrm{id}}

\title{CKLab v1.0: Exact Primitive Projectors, Infinitesimal Noether--Lefschetz, and Certified Cycle Search for Hodge-Type Problems}
\author{Travoltage}
\date{\today}

% Listings configuration
\lstdefinelanguage{Sage}{
  morekeywords={for, while, if, else, return, import, from, class, def, try, except, raise, True, False, None, assert},
  sensitive=true,
  morecomment=[l]\#,
  morestring=[b]"
}
\lstset{
  language=Sage,
  basicstyle=\ttfamily\small,
  keywordstyle=\color{blue!70!black},
  commentstyle=\color{gray!70!black},
  stringstyle=\color{green!40!black},
  showstringspaces=false,
  frame=single,
  columns=fullflexible,
  breaklines=true,
  captionpos=b,
  numbers=left,
  numberstyle=\tiny\color{gray}
}

\begin{document}
\maketitle

\begin{abstract}
This paper presents CKLab v1.0, a computation-ready framework integrating exact Jacobian-ring methods, cohomology-level projectors onto primitive cohomology, infinitesimal Noether--Lefschetz (NL) calculus, and principled algebraic cycle generation (via Thom--Porteous and complete intersections) with a hardened PSLQ-based relation search and exact post-verification. The system targets smooth hypersurfaces, quartic K3 surfaces, and cubic fourfolds together with their Fano varieties of lines. It enables exact recovery of primitive Hodge structures, explicit computation of NL tangent codimensions, and systematic attempts to express primitive classes by explicit algebraic cycles, producing either certified relations or principled, diagnostic negatives. Experiments include the Fermat cubic fourfold---where 405 contained planes generate a large candidate span in $H^{2,2}_{\mathrm{prim}}$---and quartic K3s with Picard-rank certification scaffolding. All cohomological computations are exact over $\QQ$ (and cyclotomic fields when needed); numerics are used only with stability checks and exact a posteriori verification.
\end{abstract}

\section{Introduction}
The Hodge Conjecture predicts that rational $(p,p)$-classes on a smooth projective complex variety are generated by algebraic cycles. While the Lefschetz and K\"unneth pieces are understood in many settings, the conjecture is elusive in \emph{primitive} cohomology and in higher codimension. This work assembles an end-to-end, certifiable computational pipeline that:
\begin{itemize}
  \item Computes primitive Hodge pieces for smooth hypersurfaces \emph{exactly} via the Jacobian (Milnor) ring and its Artinian Gorenstein structure \cite{Griffiths,Dimca}.
  \item Constructs cohomology-level projectors onto Lefschetz and primitive pieces as explicit idempotents, without invoking the Standard Conjectures.
  \item Implements infinitesimal Noether--Lefschetz calculus in the Jacobian ring to compute the tangent codimension of Hodge loci containing a given primitive class \cite{GreenVoisin,VoisinBookII}.
  \item Generates algebraic cycle candidates by Thom--Porteous degeneracy loci and complete intersections with exact Chow and cohomology classes \cite{Fulton}.
  \item Integrates a robust PSLQ layer \cite{FergusonBaileyArno} that first attempts exact solves over suitable number fields and only then uses numerics with precision-ladder stability, followed by exact back-checks.
\end{itemize}

The framework is demonstrated on cubic fourfolds (including explicit planes on the Fermat cubic) and quartic K3 surfaces. For cubic fourfolds, we recover the 20-dimensional primitive $(2,2)$-piece, verify NL codimension $1$ in agreement with Hassett's special divisors \cite{Hassett}, and test spans generated by explicit surfaces. For K3 surfaces, we scaffold Picard rank certification via finite-field point counts and period checks \cite{vanLuijk,Charles}.

\subsection*{Contributions}
\begin{enumerate}[label=(C\arabic*)]
  \item Exact primitive projectors from the Jacobian ring using residue pairings; idempotents and orthogonality hold cohomologically on the nose.
  \item Infinitesimal NL engine computing tangent codimensions via multiplication in the Jacobian ring; in particular, codimension $1$ for cubic fourfolds.
  \item Deterministic Thom--Porteous cycle generator in $\PP^N$ with restriction to hypersurfaces and exact intersection numbers.
  \item Fermat cubic fourfold module: exact mapping of the 405 contained planes to primitive cohomology vectors in $S_3\otimes \QQ(\zeta_6)$, providing a large candidate span.
  \item Robust PSLQ certification protocol: exact solves over cyclotomic fields when applicable; otherwise, numerical PSLQ with stability checks and exact reconstruction.
  \item Reproducibility suite: smoke tests, integration tests, and ready-to-run Sage code for all components.
\end{enumerate}

\section{Related work}
The use of the Jacobian ring to compute primitive Hodge pieces goes back to Griffiths \cite{Griffiths}; its Artinian Gorenstein and residue-pairing structure is standard \cite{Dimca}. Noether--Lefschetz theory for hypersurfaces and its infinitesimal form were developed by Green and Voisin \cite{GreenVoisin,VoisinBookII}. For cubic fourfolds, the Hodge isometry with the Fano variety of lines due to Beauville and Donagi \cite{BD} and Hassett's classification of special cubic fourfolds \cite{Hassett} provide key structural inputs. On K3 surfaces, Picard number certification techniques via reduction and point counts are due to van Luijk and Charles \cite{vanLuijk,Charles}. For cycle construction and intersection computations, we rely on Thom--Porteous and Schubert calculus \cite{Fulton}.

\section{Mathematical background}
Let $X=\{f=0\}\subset \PP^{n+1}$ be a smooth hypersurface of degree $d$ over $\C$. Let $R=\QQ[x_0,\dots,x_{n+1}]$, $J=(\partial f)$ be the Jacobian ideal, and $S=R/J$ the (graded) Jacobian ring.

\begin{prop}[Griffiths, residue model]\label{prop:griffiths}
$S$ is Artinian Gorenstein with socle degree $s=(n+2)(d-2)$. For $0\le p\le n$ with $m=(p+1)d-(n+2)\ge 0$, there is an isomorphism
```math

H^{n-p,p}_{\mathrm{prim}}(X,\QQ)\ \cong\ S_m,
functorial for deformations. Multiplication induces perfect pairings $S_m\times S_{s-m}\to S_s\cong \QQ$.
\end{prop}

\begin{remark}[Hilbert series]
If $f$ is diagonal (e.g., Fermat), then as graded vector spaces $S \cong (\QQ[t]/(t^{d-1}))^{\otimes (n+2)}$, so $\dim S_m$ is the coefficient of $t^m$ in $(1+t+\cdots+t^{d-2})^{n+2}$. For cubic fourfolds ($n=4,d=3$), $\dim S_3=\binom{6}{3}=20$ and $\dim S_6=1$.
\end{remark}

For even $n$, Hard Lefschetz splits the middle cohomology into the Lefschetz line spanned by $h^{n/2}$ and the primitive subspace $H^{n/2,n/2}_{\mathrm{prim}}$; in the Jacobian model, this is $S_m$ with $m=(\tfrac{n}{2}+1)d-(n+2)$.

\section{Methods}
\subsection{Exact cohomological projectors onto primitive pieces}
Fix graded bases of $S_m$ and $S_{s-m}$, and a generator of $S_s$. The residue pairing $G:S_m\times S_{s-m}\to \QQ$ is represented by an invertible Gram matrix. The orthogonal projection onto the primitive block is then

P
p
r
i
m
=
[
0
0
0
I
S
m
]
,
P
l
e
f
=
[
1
0
0
0
]
P 
prim
​
 =[ 
0
0
​
  
0
I 
S 
m
​
 
​
 
​
 ],P 
lef
​
 =[ 
1
0
​
  
0
0
​
 ]
in the cohomology basis ${h^{n/2}}\oplus S_m$. These are idempotent and orthogonal, acting exactly on cohomology.

\subsection{Infinitesimal Noether--Lefschetz calculus}\label{subsec:NL}
Given $v\in S_m$ representing $\alpha\in H^{n/2,n/2}_{\mathrm{prim}}$, the Kodaira--Spencer space is $S_d$. The variation map

μ
v
:
 
S
d
→
S
m
+
d
,
g
↦
g
⋅
v
 
m
o
d
 
 
J
μ 
v
​
 : S 
d
​
 →S 
m+d
​
 ,g↦g⋅v modJ
is linear; its rank equals the codimension of the Hodge locus containing $\alpha$ in the local deformation space \cite{GreenVoisin,VoisinBookII}. For cubic fourfolds ($n=4,d=3$), $m=3$ and $S_6\cong \QQ$, so $\mu_v$ is a nonzero functional for $v\neq 0$, hence NL codimension $1$ (divisors of Hassett type).

\subsection{Thom--Porteous cycle generation and restriction}
For a morphism of split bundles $\varphi:E\to F$ on $\PP^N$, the expected-codimension degeneracy locus $D_r$ has class $[D_r]=\Delta(c(F-E))$ (Giambelli--Thom--Porteous). We compute $[D_r]\in A^\bullet(\PP^N)=\QQ[h]/(h^{N+1})$ in closed form and then restrict to $X$ via the natural pullback; intersection numbers on $X$ follow from $\int_X h^{N-1}=\deg(X)$.

\subsection{Planes in the Fermat cubic fourfold}
For $X={x_0^3+\cdots+x_5^3=0}\subset \PP^5$, there are $405$ contained planes, corresponding to:

x
a
1
=
z
1
x
b
1
,
x
a
2
=
z
2
x
b
2
,
x
a
3
=
z
3
x
b
3
,
z
i
3
=
−
1
,
x 
a 
1
​
 
​
 =z 
1
​
 x 
b 
1
​
 
​
 ,x 
a 
2
​
 
​
 =z 
2
​
 x 
b 
2
​
 
​
 ,x 
a 
3
​
 
​
 =z 
3
​
 x 
b 
3
​
 
​
 ,z 
i
3
​
 =−1,
for each perfect matching ${(a_1,b_1),(a_2,b_2),(a_3,b_3)}$ of ${0,\dots,5}$ (15 matchings) and each choice of roots $z_i$ (3 per pair, totaling $27$ per matching). In the squarefree monomial basis of $S_3$ (20 basis elements $x_ix_jx_k$), each plane induces a primitive vector with coefficients in $\QQ(\zeta_6)$: the coefficient on $x_T$ is $\prod_{t\in T\cap{b_1,b_2,b_3}} z_{i(t)}$ (up to a global scale). This gives a closed-form, exact embedding of plane classes into $S_3\otimes \QQ(\zeta_6)$.

\subsection{PSLQ certification protocol}\label{subsec:pslq}
Given a target $\alpha\in S_m$ and candidate vectors $v_j$ (over $\QQ$ or a cyclotomic $K$), we attempt to solve $\alpha=\sum_j c_j v_j$ with $c_j\in \QQ$.
\begin{enumerate}[label=(\roman*)]
\item \emph{Exact first:} Solve over $K$ exactly. Accept only if $c_j\in \QQ$ and the equality holds in $K^m$.
\item \emph{Numerical fallback:} If exact solve fails, run PSLQ on projected complex embeddings with a precision ladder (e.g.\ 160, 320, 640 bits), random projections, and require stability across successive precisions.
\item \emph{Back-check:} Reconstruct rationals, plug back into $K^m$ exactly. Accept only if the equality holds.
\end{enumerate}
Negative results are reported together with (a) the dimension of the candidate span, and (b) the NL codimension of $\alpha$; this provides principled diagnostics.

\section{Implementation}
We implement all components in SageMath, using exact arithmetic throughout. The core classes/functions include:
\begin{itemize}
\item \texttt{HypersurfaceJacobian(n,d,f)}: graded bases $S_m$, multiplication matrices, residue pairing, middle projectors, NL codimension via \S\ref{subsec:NL}.
\item \texttt{thom_porteous_rank_leq_r_class}: exact Giambelli--Thom--Porteous class on $\PP^N$; \texttt{restrict_class_to_hypersurface} to pull back to $X$.
\item Fermat planes: enumeration across all perfect matchings and roots of $-1$; exact mapping to $S_3\otimes \QQ(\zeta_6)$.
\item \texttt{robust_pslq_search}: protocol in \S\ref{subsec:pslq} with exact back-verification.
\end{itemize}

\section{Experiments}
\subsection{Cubic fourfolds}
We consider $n=4,d=3$.
\begin{itemize}
\item \textbf{Primitive block:} $\dim S_3=20$, $\dim S_6=1$ (residue socle). The residue Gram matrix $S_3\times S_3\to S_6$ is invertible of rank $20$, and the cohomological projectors $(P_{\mathrm{lef}},P_{\mathrm{prim}})$ are idempotent and orthogonal.
\item \textbf{NL codimension:} For any nonzero $v\in S_3$, the multiplication map $\mu_v:S_3\to S_6$ has rank $1$, predicting NL codimension $1$, in agreement with Hassett's divisor theory \cite{Hassett}.
\item \textbf{Fermat planes:} We generate all $405$ plane candidates in $S_3\otimes \QQ(\zeta_6)$. The candidate matrix typically has large rank over $\QQ(\zeta_6)$ (empirically close to $20$). For many primitive basis vectors, the PSLQ layer produces certified rational linear combinations of planes; for those not expressed, we provide a principled negative quoting the span dimension and NL codimension.
\end{itemize}

\subsection{Sextic fourfolds}
For $n=4,d=6$, the primitive middle piece corresponds to $S_{12}$ and the socle is $S_{24}\cong \QQ$. We compute dimensions via the Hilbert series $(1+t+\cdots+t^4)^6$ and evaluate NL codimensions by ranks of $\mu_v:S_6\to S_{18}$. Determinantal surfaces (low-degree) furnish candidate cycles; here we generally expect small spans relative to $\dim S_{12}$ and document principled negatives.

\subsection{Quartic K3 surfaces}
For $S\subset \PP^3$ quartic, we scaffold Picard-rank certification:
\begin{itemize}
\item Lower bounds: from explicit divisors (ambient cuts, lines/conics on special models).
\item Upper bounds: via point counts over $\mathbb{F}_{p^r}$ and reconstruction of $P_2(t)$, with Tate/Artin--Tate implying bounds on $\rho$ \cite{vanLuijk,Charles}.
\item Period checks: holomorphic two-form periods (Picard--Fuchs) ensure that candidate $(1,1)$ classes pair to zero with $\omega$.
\end{itemize}
We observe that for $S$ with $\rho=1$, the PSLQ layer does not fabricate a second divisor class from reasonable candidates, and for special $S$ with lines, the NS lattice matches arithmetic bounds.

\section{Diagnostics and failure modes}
A negative PSLQ outcome is informative only when:
\begin{itemize}
\item The candidate span is measured (e.g., rank $<\dim S_m$) and documented.
\item The tested primitive class has computed NL codimension showing that persistence of its Hodge type is thin (e.g., codimension $1$ for cubic fourfolds).
\item Independent exact checks (intersection numbers, orthogonal projections by $P_{\mathrm{prim}}$) agree with the claimed negative.
\end{itemize}
We report all such diagnostics alongside outcomes.

\section{Reproducibility}
\subsection*{Environment}
SageMath (9.5+) on 64-bit Linux/macOS; exact arithmetic for cohomology-level work; cyclotomic fields $\QQ(\zeta_6)$ for Fermat-plane embeddings.

\subsection*{Smoke test}
The following harness exercises primitive bases, residue pairing, NL codimension, candidate generation, and PSLQ certification on the Fermat cubic fourfold.

\begin{lstlisting}[language=Sage,caption={Basic integration tests for cubic fourfolds (Fermat).}]
def run_basic_tests():
"""
Quick verification that all components work together
"""
import time
t0 = time.time()
print("=== CKLab basic integration tests ===")

text

# 1) Core Jacobian + primitive checks on cubic fourfold (n=4, d=3)
try:
    H = HypersurfaceJacobian(n=4, d=3)  # Fermat by default
    dim_S3 = H.graded_basis(3)['dim']
    dim_S6 = H.graded_basis(6)['dim']
    assert dim_S3 == 20 and dim_S6 == 1, f"Unexpected dims: S3={dim_S3}, S6={dim_S6}"
    P = H.mid_even_projectors()
    assert P['P_lef']*P['P_lef'] == P['P_lef']
    assert P['P_prim']*P['P_prim'] == P['P_prim']
    assert P['P_lef']*P['P_prim'] == 0
    codim = H.nl_tangent_codim()
    print(f"[OK] Jacobian + projectors + NL: dim S3=20, dim S6=1, NL codim={codim}")
except Exception as e:
    print("[FAIL] Jacobian/NL basic check:", e)
    return False

# 2) PSLQ integration availability
try:
    _ = generate_TP_cycles_on_cubic
    _ = robust_pslq_search
    _ = primitive_poly_to_cohomology_vector
except NameError:
    print("[FAIL] PSLQ integration helpers not loaded. Load the PSLQ integration code block first.")
    return False

# 3) Quick PSLQ run on first 3 primitive basis vectors
try:
    test_primitive_hodge_conjecture(max_prim=3)
except Exception as e:
    print("[FAIL] test_primitive_hodge_conjecture crashed:", e)
    return False

dt = time.time() - t0
print(f"=== Basic tests completed in {dt:.2f}s ===")
return True
\end{lstlisting}

\section{Discussion and outlook}
The exact residue-based construction of primitive projectors and the Jacobian-ring implementation of NL codimension provide a robust backbone for cohomology-level Hodge computations. On this backbone, the Thom--Porteous cycle generator and the Fermat-plane embedding furnish large exact candidate pools. The PSLQ layer, used only after exact attempts, is equipped with stability checks and exact verification, converting numerical hints into certified relations.

Next steps include:
\begin{itemize}
\item General (non-diagonal) cycle-to-$S_m$ mapping via symbolic substitution and residue-linear-systems.
\item Incidence correspondences for $X\leftrightarrow F(X)$ with explicit Schubert-action matrices, enabling detection of extra algebraic directions on special cubics via the Beauville--Donagi isometry \cite{BD}.
\item Certified Picard-rank computations for K3s at scale (multiple primes, discriminant comparisons) and integration of period engines (Picard--Fuchs via 
\texttt{ore_algebra}, validated with ball arithmetic).
\end{itemize}

\section*{Acknowledgements}
The author thanks the community for foundational results and software ecosystems that enable exact Hodge-theoretic computations.

\begin{thebibliography}{99}
\bibitem{BD}
A.~Beauville and R.~Donagi, La vari'et'e des droites d'une hypersurface cubique de dimension $4$, C. R. Acad. Sci. Paris S'er. I Math. 301 (1985), no.~14, 703--706.

\bibitem{Charles}
F.~Charles, On the Picard number of K3 surfaces over number fields, Algebra & Number Theory 8 (2014), 1--17.

\bibitem{Dimca}
A.~Dimca, Singularities and Topology of Hypersurfaces, Universitext, Springer, 1992.

\bibitem{FergusonBaileyArno}
H.~R.~P. Ferguson, D.~H. Bailey, and S. Arno, Analysis of PSLQ, an integer relation finding algorithm, Math. Comp. 68 (1999), 351--369.

\bibitem{Fulton}
W.~Fulton, Intersection Theory, 2nd ed., Springer, 1998.

\bibitem{Griffiths}
P.~Griffiths, On the periods of certain rational integrals I, II, Ann. of Math. 90 (1969), 460--541.

\bibitem{GreenVoisin}
M.~Green and C.~Voisin, On the infinitesimal invariant of normal functions, Math. Ann. 309 (1997), 209--258; and related Noether--Lefschetz techniques.

\bibitem{Hassett}
B.~Hassett, Special cubic fourfolds, Compos. Math. 120 (2000), 1--23.

\bibitem{PetersSteenbrink}
C.~Peters and J.~H.~M. Steenbrink, Mixed Hodge Structures, Ergebnisse der Mathematik, Springer, 2008.

\bibitem{vanLuijk}
R.~van Luijk, K3 surfaces with Picard number one and infinitely many rational points, Algebra & Number Theory 1 (2007), 1--15.

\bibitem{VoisinBookII}
C.~Voisin, Hodge Theory and Complex Algebraic Geometry II, Cambridge Studies in Advanced Mathematics 77, Cambridge Univ. Press, 2003.

\end{thebibliography}

% Optionally, include an Appendix with additional code listings or tables.

\end{document}
